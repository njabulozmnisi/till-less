# Story 6.2: Ops Runbooks & Performance Baselines

## Status
Draft

## Story
**As a** TillLess operations lead,
**I want** runbooks, monitoring, and performance baselines,
**so that** the team can respond quickly to incidents and ensure the MVP meets SLAs.

## Acceptance Criteria
1. Runbooks in `docs/ops/` cover optimisation API incidents, BetterAuth outages, Supabase failures, and Temporalite issues with detection, triage, rollback steps. [Source: docs/architecture/04-4-component-breakdown.md#48-observability--ops]
2. Load testing (k6/Artillery) validates optimisation API P95 < 30s for 60-item lists; results captured with recommendations. [Source: docs/architecture/07-7-non-functional-considerations.md#7-non-functional-considerations]
3. Synthetic monitoring (GitHub cron or Grafana Synthetic) hits optimisation health endpoints hourly, alerting on failures/latency breaches. [Source: docs/architecture/09-9-monitoring-alerting.md#9-monitoring--alerting]
4. On-call rotation documented with escalation matrix, contact info, and tooling access checklist. [Source: docs/prd/12-12-risks-mitigations.md#12-risks-mitigations]
5. Post-incident report template created with guidance on timelines, impact, root cause, and action items. [Source: docs/architecture/04-4-component-breakdown.md#48-observability--ops]
6. QA evidence includes runbook links, load test report, monitoring screenshots, and on-call documentation. [Source: docs/architecture/testing-strategy.md#testing-strategy]

## Tasks / Subtasks
- [ ] Runbook authoring (AC: 1, 4)
  - [ ] Draft/update `docs/ops/optimisation-runbook.md`, `docs/ops/betterauth-runbook.md`, and `docs/ops/supabase-runbook.md` with detection steps, dashboards, rollback procedures, and escalation contacts. [Source: docs/architecture/04-4-component-breakdown.md#48-observability--ops]
  - [ ] Create on-call handbook in `docs/ops/on-call.md` covering schedule, comms channels, tooling access. [Source: docs/prd/12-12-risks-mitigations.md#12-risks-mitigations]
- [ ] Performance baseline (AC: 2)
  - [ ] Design k6/Artillery scripts simulating 60-item list optimisations, execute against staging, record P95 latency, CPU/memory metrics, and recommendations. [Source: docs/architecture/07-7-non-functional-considerations.md#7-non-functional-considerations]
  - [ ] Store results in `docs/ops/performance-report.md` with pass/fail criteria.
- [ ] Synthetic monitoring (AC: 3)
  - [ ] Configure GitHub Actions or Grafana Synthetic checks hitting optimisation health endpoints hourly, with Slack alerts on failure/latency >25s. [Source: docs/architecture/09-9-monitoring-alerting.md#9-monitoring--alerting]
  - [ ] Document alert payloads and remediation steps in runbooks.
- [ ] Post-incident process (AC: 5)
  - [ ] Create post-incident review template in `docs/ops/post-incident-template.md` including timeline, impact, root cause, follow-up tasks. [Source: docs/architecture/04-4-component-breakdown.md#48-observability--ops]
  - [ ] Schedule tabletop exercise/walkthrough with team.
- [ ] QA artifacts (AC: 6)
  - [ ] Compile runbook links, load test outputs, monitoring screenshots, and on-call documentation for QA checklist.
  - [ ] Ensure documentation stored in version control with change history.

## Dev Notes
**Dependencies**
- Requires deployed environments (Story 6.1) and monitoring hooks from Story 1.4 to feed metrics/alerts.

**Performance Goals**
- Keep P95 under 30s; document actions if exceeded (e.g., caching, database tuning).

**Monitoring**
- Synthetic checks should reuse existing dashboards; integrate with on-call Slack channel.

**On-Call**
- Define rotation length, primary/secondary contact, escalation to leadership, and required tooling (Grafana, Supabase console, Render/Vercel).

### Testing
- Performance testing: k6/Artillery script results attached. [Source: docs/architecture/testing-strategy.md#testing-strategy]
- Monitoring validation: intentionally disable endpoint to ensure alert fires; capture logs.
- Manual QA: review runbooks, confirm contact details, test post-incident template by running mock scenario.
- Key scenarios: optimisation latency spike, BetterAuth outage, Supabase failure, on-call handoff.

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2025-09-28 | v0.1 | Initial draft prepared by Scrum Master | Bob |

## Dev Agent Record
### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results
| Date | Reviewer | Outcome | Notes |
| --- | --- | --- | --- |
