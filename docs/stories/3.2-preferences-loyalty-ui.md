# Story 3.2: Preferences & Loyalty Management UI

- **Status:** Draft
- **Epic:** 3 â€“ Shopping List Experience (Frontend)
- **Related PRD Sections:** `docs/prd/04-4-target-users-personas.md`, `docs/prd/07-7-detailed-requirements.md`
- **Related Architecture Sections:** `docs/architecture/04-4-component-breakdown.md`

## Story Statement
Provide a preferences dashboard where users manage loyalty cards, effort tolerance, value-of-time, and store radius settings to influence optimisation outcomes.

## Acceptance Criteria
- [ ] Authenticated preferences page displaying loyalty card toggles (Checkers, PnP, Shoprite, Woolworths, Makro) with BetterAuth-protected API calls.
- [ ] Inputs for max stores, max distance, value-of-time (R/hour) with validation and helper text.
- [ ] Persistent storage via backend (PATCH/GET endpoints) with optimistic UI updates.
- [ ] UI reflects current settings when page loads; includes reset-to-default option.
- [ ] Tests cover form validation and API interactions.

## Tasks & Subtasks
1. **UI Components**
   - Build toggle list, numeric inputs, select components with accessible labels.
2. **State & API Wiring**
   - Fetch preferences on load using React Query; submit updates with optimistic response handling.
3. **BetterAuth Integration**
   - Ensure tokens/claims required for preferences scope are handled.
4. **Error Handling**
   - Display inline errors, fallback messages on network issues, and toast notifications on success.
5. **Testing & Documentation**
   - Component/unit tests, update user guide with screenshot and instructions.

## Dependencies
- Backend preferences endpoints (Epic 4 story) implemented.

## QA Checklist
- [ ] Screenshot/video of page interactions.
- [ ] Evidence of settings persisting across reloads.

## Implementation Log
| Date | Author | Notes |
| --- | --- | --- |

## QA Results
| Date | Reviewer | Outcome | Notes |
| --- | --- | --- | --- |

## File Tracker
- _To be completed during implementation._
