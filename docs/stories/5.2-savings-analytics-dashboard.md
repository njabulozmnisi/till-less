# Story 5.2: Savings & Accuracy Analytics

- **Status:** Draft
- **Epic:** 5 â€“ Feedback Loop & Analytics
- **Related PRD Sections:** `docs/prd/10-10-analytics-telemetry.md`
- **Related Architecture Sections:** `docs/architecture/09-9-monitoring-alerting.md`

## Story Statement
Build analytics views that compare predicted vs. actual spend, track savings over time, and surface mapping issues for manual review.

## Acceptance Criteria
- [ ] Postgres materialised view or ETL job computes variance metrics (predicted vs. actual totals, item-level mismatches).
- [ ] Metabase/Grafana dashboards visualise monthly savings, accuracy %, and top variances by retailer/item.
- [ ] Alerts triggered when variance exceeds threshold (>5%) for two consecutive runs for same store.
- [ ] Analyst workflow to flag mismatched items into `product_matching_queue`.
- [ ] Documentation for interpreting dashboards and responding to variance alerts.

## Tasks & Subtasks
1. **Data Aggregation**
   - Create SQL views or Prisma ETL to join optimisation runs with receipts.
2. **Dashboards**
   - Configure Metabase questions/cards for savings trend, variance heatmap.
3. **Alerting**
   - Implement scheduled job (GitHub Action) evaluating variance thresholds and posting to Slack.
4. **Analyst Tools**
   - Add admin UI link to push mismatches to queue with notes.
5. **Docs & Training**
   - Update analyst handbook with dashboard usage, alert response steps.

## Dependencies
- Story 5.1 completed (receipts captured).
- Monitoring infra from Epic 1/6 in place for alert delivery.

## QA Checklist
- [ ] Dashboard screenshots/export attached.
- [ ] Alert test evidence.

## Implementation Log
| Date | Author | Notes |
| --- | --- | --- |

## QA Results
| Date | Reviewer | Outcome | Notes |
| --- | --- | --- | --- |

## File Tracker
- _To be completed during implementation._
