# Story 6.1: CI/CD & Deployment Automation

- **Status:** Draft
- **Epic:** 6 â€“ Ops & Reliability Enhancements
- **Related PRD Sections:** `docs/prd/11-11-release-plan.md`
- **Related Architecture Sections:** `docs/architecture/08-8-deployment-environments.md`

## Story Statement
Automate build, test, and deployment pipelines for NestJS, Next.js, and Temporalite components to ensure consistent releases across environments.

## Acceptance Criteria
- [ ] GitHub Actions workflow runs lint, unit tests, integration tests, and Prisma migrations on PRs.
- [ ] Successful merges trigger deployment to staging (Render/Vercel) with environment-specific configs.
- [ ] Temporalite workflow definitions automatically deployed via CI (docker image/pnpm script).
- [ ] Secrets managed via GitHub Actions + environment stores with documented rotation.
- [ ] CI pipeline status badges added to README.

## Tasks & Subtasks
1. **CI Pipeline Setup**
   - Configure Node 20 + pnpm caching; run lint/test steps.
2. **Database Migration Automation**
   - Add job running `supabase db push` or `prisma migrate deploy` before deploy.
3. **Deployment Scripts**
   - Configure Render/Vercel CLI deploys using API tokens.
4. **Temporalite Release**
   - Build/publish Docker image for workflows; update docker-compose on staging via CI.
5. **Documentation**
   - Update `docs/ops/` with pipeline overview and rollback steps.

## Dependencies
- Core services (Epics 1-4) have build scripts ready.

## QA Checklist
- [ ] CI run logs attached showing pipeline success.
- [ ] Deployment verification evidence (staging URL snapshot).

## Implementation Log
| Date | Author | Notes |
| --- | --- | --- |

## QA Results
| Date | Reviewer | Outcome | Notes |
| --- | --- | --- | --- |

## File Tracker
- _To be completed during implementation._
